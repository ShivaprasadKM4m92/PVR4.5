//# sourceMappingURL=copyPasteValues.js.map
(function(){$("toAddContainer").ready(function(){function k(){return $("#copyAndPasteModal .copyPasteContent").val()}function e(a){return $(getFieldFromExpression(a)).select2("val")}function h(a){$("#copyAndPasteModal .copyPasteContent").val(a)}var d=$("#copyAndPasteModal"),c,l=function(){var a=$("#copyAndPasteModal input:radio[name^=delimiter]:checked").val();return"none"===a?null:"others"===a?(a=$("#copyAndPasteModal .c_n_p_other_delimiter").val(),_.isEmpty(a)?null:a):a},n=function(){d.off("click.confirm").on("click.confirm",
".confirm-paste",function(a){a.preventDefault();$(this).parentsUntil(".modal").parent().modal("hide");a=k();"Select Field"!==e(c)&&$(c).trigger("copyAndPaste:paste",[a])})},p=function(){d.off("click.import").on("click.import",".import-values",function(a){a.preventDefault();d.find(":file").val()&&($("#file_input").val(),a=new FormData,a.append("file",$("#file_input").get(0).files[0]),a.append("selectedField",e(c)),$.ajax({url:importExcel,type:"POST",data:a,mimeType:"multipart/form-data",contentType:!1,
cache:!1,processData:!1,success:function(a){$response=$.parseJSON(a);$response.success?m($response):($("#noDataInExcel").show().text($response.message),setTimeout(function(){$("#noDataInExcel").hide()},1E4))}}))})},m=function(a,b){b?($("#importValuesTemplateContainer").html(a.uploadedValues),$(".importValueModal").modal("show"),q(),$("#showWarnings").on("click",function(){$(".invalidValuesContainer").attr("hidden")?$(".invalidValuesContainer").removeAttr("hidden"):$(".invalidValuesContainer").attr("hidden",
"hidden")})):h(a.uploadedValues);$("#copyAndPasteModal input:radio[name^=delimiter][value=\\;]").prop("checked",!0);$(".confirm-paste").show();$(".import-values").hide()},q=function(){$(".importValueModal").off("click.import-values").on("click.import-values",".confirm-import",function(a){a.preventDefault();h(validValues)})};(function(){$(document).on("copyAndPaste:paste",function(a,b){a=getValueTextFromExpression(c);var f=l(),g=e(c);null!=f&&("|"==f&&(f="\\|"),b=b.replace(new RegExp("\\s*"+f+"\\s*",
"g"),";"));null==b||_.isEmpty(b)||(copyAndPastesFields[g]={field:g,content:b,delimiter:f},$(a).val(b).trigger("change"),$(c).trigger("query.builder.updateAJAXValues"))});d.on("show.bs.modal",function(a){a=e(c);var b="";getFieldIsValidatableFromExpression(c)?$(".validate-copy-paste").removeAttr("disabled"):$(".validate-copy-paste").attr("disabled","disabled");_.contains(_.keys(copyAndPastesFields),a)?(a=copyAndPastesFields[a],b=a.content.replace(/\\s*;\\s*/g,a.delimiter)):($(d).find("input:radio[id=delimiter_none]").prop("checked",
!0),b=getCorrectSelectValueFromContainer(c),b=$(b).val());_.isArray(b)&&(b=_.filter(b,function(a){return!_.isEmpty(a)}).join(";"));h(b)});d.on("change",":file",function(){var a=$(this),b=a.get(0).files?a.get(0).files.length:0,c=a.val().replace(/\\/g,"/").replace(/.*\//,""),g=[".xlsx",".xls"],d=c.substring(c.lastIndexOf("."));0<b?($(".confirm-paste").hide(),$(".import-values").show(),0>g.indexOf(d.toLowerCase())?($("#fileFormatError").show(),$(".import-values").attr("disabled","disabled")):($("#fileFormatError").hide(),
$(".import-values").removeAttr("disabled"))):($("#fileFormatError").hide(),$(".import-values").hide(),$(".confirm-paste").show());a.trigger("fileselect",[b,c])});$(":file").on("fileselect",function(a,b,c){a=$(this).parents(".input-group").find(":text");a.length&&a.val(0<b?c:"")});$(".showValue.showSelect").popover({content:function(){return $(this).find("#selectValue").val()},show:!0,trigger:"hover"});$(document).on("click",".validate-copy-paste",function(a){a=k();var b=l(),d=e(c);null!=b&&("|"==
b&&(b="\\|"),a=a.replace(new RegExp("\\s*"+b+"\\s*","g"),";"));$.ajax({url:validateValue,type:"POST",mimeType:"multipart/form-data",data:{selectedField:d,values:a},success:function(a){a=JSON.parse(a);a.success&&m(a,!0)},error:function(a){alert(a)}})});d.on("hidden.bs.modal",function(a){c=void 0});n();p();$("#queryBuilder, #advancedCustomExpression").on("click",".modal-link",function(a){a.preventDefault();c=$(this).closest("div .toAddContainer");a=getFieldType($(getFieldFromExpression(c)).find(":selected"));
a!==RF_TYPE_DATE&&a!==RF_TYPE_PART_DATE&&d.modal("show")})})()})})();